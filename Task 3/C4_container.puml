@startuml
!include <C4/C4_Container>

title Диаграмма контейнеров: детализация компонентов

Person(клиент, "Клиент", "Подаёт заявку на депозит")

System_Boundary(интернет_банк, "Интернет-банк") {
    Container(ui, "Веб-интерфейс", "ASP.NET MVC", "Формы заявок")
    Container(api_gateway, "API Gateway", "Nginx", "Маршрутизация запросов")
}

System_Boundary(микросервисы, "Микросервисы") {
    Container(депозиты_ms, "Микросервис депозитов", "Java Spring Boot", "Обработка заявок, кэш ставок")
    ContainerDb(redis, "Кэш ставок", "Redis", "Хранение актуальных ставок")
}

System_Boundary(абс, "АБС") {
    Container(абс_ядро, "Ядро АБС", "Delphi", "Бухгалтерские операции")
    ContainerDb(oracle_db, "БД АБС", "Oracle", "Хранение договоров")
}

System(смс_шлюз, "СМС-шлюз", "Внешний сервис телеком-оператора")

Rel(клиент, ui, "Взаимодействие с формами", "HTTPS")
Rel(ui, api_gateway, "API-вызовы", "REST")
Rel(api_gateway, депозиты_ms, "Маршрутизация запросов", "HTTP/JSON")
Rel(депозиты_ms, redis, "Кэширование ставок", "TCP")
Rel(депозиты_ms, абс_ядро, "Синхронизация данных", "Kafka")
Rel(депозиты_ms, смс_шлюз, "Инициирующие SMS")
Rel(абс_ядро, oracle_db, "Запись операций", "PL/SQL")
Rel(абс_ядро, смс_шлюз, "Финальные уведомления")
@enduml